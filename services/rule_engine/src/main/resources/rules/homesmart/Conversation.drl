package rules.homesmart;
import com.mindsmiths.telegramAdapter.TelegramReceivedMessage;
import agents.Homesmart;
import com.mindsmiths.ruleEngine.model.Initialize;
import com.mindsmiths.ruleEngine.model.Heartbeat;
import java.util.Date;


rule "Re-engage user"
    when
        Heartbeat(ts: timestamp) from entry-point "signals"
        agent: Homesmart(
            lastInteractionTime before[10s] ts
        )
    then
        modify(agent) {
            setLastInteractionTime(new Date())
        };
        agent.sendMessage("Are you interested in a purchase of Real Estate?");
end

rule "First contact"
    salience 100
    when
        initialize: Initialize() from entry-point "agent-created"
        message: TelegramReceivedMessage() from entry-point "signals"
        agent: Homesmart()
    then
        agent.sendMessage("Hello, my name is Homesmart, a smart Real Estate agent!\nAre you interested in a purchase of Real Estate?");
        delete(message);
end